package ex32;

import static v.ArrayUtils.*;

import java.util.Iterator;

import st.BSTX;
import v.Tuple2;

/* p417
  3.2.11  How many binary tree shapes of N nodes are there with height N? 
  How many different ways are there to insert N distinct keys into an 
  initially empty BST that result in a tree of height N? (See Exercise 3.2.2.)
  
  This can't be sensible and mean height as defined in BST.java since then
  the answer is always 0*.  However if BST.height()+1 is used as binary tree
  height then the answer is 2^N because a tree of max height is always formed
  by one chain or path of nodes and the number of such chains is determined
  by the greater or less than property of keys of adjacent nodes that controls
  left/right branching between them. In the end all combinations of branching
  are possible giving 2^n tree shapes, assuming distinct keys. This is 
  experimentally demonstrated below for N == 6.
  
  * That begs the question: Why not define BST height to be the same as binary
    tree height. The article at 
      http://www.geeksforgeeks.org/iterative-method-to-find-height-of-binary-tree/
    mentions there are two conventions for defining binary tree height: (1) the
    Number of nodes on longest path from root to the deepest node; (2) the 
    Number of links on longest path from root to the deepest node.
    Most of the problem is due to binary trees never being treated directly as 
    an independent subject nor height exactly defined for them in this text.
    
  experimental results:
      #unique binary trees
  N      with height N      formula
  1   1                     2^0
  2   2                     2^1
  3   4                     2^2
  4   8                     2^3
  5   16                    2^4
  6   32                    2^5
  6   64                    2^6
  
*/

public class Ex3211HowManyBSTsWithNnodesAndHeightN {
  
  public static void howManyBSTsWithNnodesAndHeightN(int n) {
    Integer[] a = rangeInteger(0,n), b = rangeInteger(0,n), d = new Integer[n]; 
    int[] c; String es, ds;
    BSTX<String,Tuple2<String,BSTX<Integer,Integer>>> map = new BSTX<>();
    BSTX<Integer,Integer> bst;
    Iterator<int[]> it = permutations(range(0,n));
    while(it.hasNext()) {
      c = it.next();
      for (int i = 0; i < d.length; i++) d[i] = a[c[i]];
      bst = new BSTX<Integer,Integer>(d,b);
      ds = arrayToString(d,80,1,1);
      es = arrayToString(bst.toPreOrderArray(),80,1,1);
      if (bst.height()+1 == n) {
        if (map.contains(es)) map.get(es)._1 += " "+ds;
        else map.put(es, new Tuple2<String,BSTX<Integer,Integer>>(ds,bst));
      }
    }
    System.out.println("there are "+map.size()+" unique binary tree shapes with "+n
        +" nodes and height "+n+" as follows:\n");
    Iterator<String> ti = map.inOrder().iterator();
    while (ti.hasNext()){
      Tuple2<String,BSTX<Integer,Integer>> g = map.get(ti.next());
      System.out.println(g._1);
      g._2.printTree(); System.out.println();
    } 
  }
  
  public static void main(String[] args) {
    
    howManyBSTsWithNnodesAndHeightN(7);
     
/*
there are 64 unique binary tree shapes with 7 nodes and height 7 as follows:

there are 64 unique binary tree shapes with 7 nodes and height 7 as follows:

    [0,1,2,3,4,5,6]
    |                                          /-----6
    |                                   /-----5
    |                            /-----4
    |                     /-----3
    |              /-----2
    |       /-----1
     \-----0
    
    [0,1,2,3,4,6,5]
    |                                   /-----6
    |                                  |       \-----5
    |                            /-----4
    |                     /-----3
    |              /-----2
    |       /-----1
     \-----0
    
    [0,1,2,3,6,4,5]
    |                            /-----6
    |                           |      |       /-----5
    |                           |       \-----4
    |                     /-----3
    |              /-----2
    |       /-----1
     \-----0
    
    [0,1,2,3,6,5,4]
    |                            /-----6
    |                           |       \-----5
    |                           |              \-----4
    |                     /-----3
    |              /-----2
    |       /-----1
     \-----0
    
    [0,1,2,6,3,4,5]
    |                     /-----6
    |                    |      |              /-----5
    |                    |      |       /-----4
    |                    |       \-----3
    |              /-----2
    |       /-----1
     \-----0
    
    [0,1,2,6,3,5,4]
    |                     /-----6
    |                    |      |       /-----5
    |                    |      |      |       \-----4
    |                    |       \-----3
    |              /-----2
    |       /-----1
     \-----0
    
    [0,1,2,6,5,3,4]
    |                     /-----6
    |                    |       \-----5
    |                    |             |       /-----4
    |                    |              \-----3
    |              /-----2
    |       /-----1
     \-----0
    
    [0,1,2,6,5,4,3]
    |                     /-----6
    |                    |       \-----5
    |                    |              \-----4
    |                    |                     \-----3
    |              /-----2
    |       /-----1
     \-----0
    
    [0,1,6,2,3,4,5]
    |              /-----6
    |             |      |                     /-----5
    |             |      |              /-----4
    |             |      |       /-----3
    |             |       \-----2
    |       /-----1
     \-----0
    
    [0,1,6,2,3,5,4]
    |              /-----6
    |             |      |              /-----5
    |             |      |             |       \-----4
    |             |      |       /-----3
    |             |       \-----2
    |       /-----1
     \-----0
    
    [0,1,6,2,5,3,4]
    |              /-----6
    |             |      |       /-----5
    |             |      |      |      |       /-----4
    |             |      |      |       \-----3
    |             |       \-----2
    |       /-----1
     \-----0
    
    [0,1,6,2,5,4,3]
    |              /-----6
    |             |      |       /-----5
    |             |      |      |       \-----4
    |             |      |      |              \-----3
    |             |       \-----2
    |       /-----1
     \-----0
    
    [0,1,6,5,2,3,4]
    |              /-----6
    |             |       \-----5
    |             |             |              /-----4
    |             |             |       /-----3
    |             |              \-----2
    |       /-----1
     \-----0
    
    [0,1,6,5,2,4,3]
    |              /-----6
    |             |       \-----5
    |             |             |       /-----4
    |             |             |      |       \-----3
    |             |              \-----2
    |       /-----1
     \-----0
    
    [0,1,6,5,4,2,3]
    |              /-----6
    |             |       \-----5
    |             |              \-----4
    |             |                    |       /-----3
    |             |                     \-----2
    |       /-----1
     \-----0
    
    [0,1,6,5,4,3,2]
    |              /-----6
    |             |       \-----5
    |             |              \-----4
    |             |                     \-----3
    |             |                            \-----2
    |       /-----1
     \-----0
    
    [0,6,1,2,3,4,5]
    |       /-----6
    |      |      |                            /-----5
    |      |      |                     /-----4
    |      |      |              /-----3
    |      |      |       /-----2
    |      |       \-----1
     \-----0
    
    [0,6,1,2,3,5,4]
    |       /-----6
    |      |      |                     /-----5
    |      |      |                    |       \-----4
    |      |      |              /-----3
    |      |      |       /-----2
    |      |       \-----1
     \-----0
    
    [0,6,1,2,5,3,4]
    |       /-----6
    |      |      |              /-----5
    |      |      |             |      |       /-----4
    |      |      |             |       \-----3
    |      |      |       /-----2
    |      |       \-----1
     \-----0
    
    [0,6,1,2,5,4,3]
    |       /-----6
    |      |      |              /-----5
    |      |      |             |       \-----4
    |      |      |             |              \-----3
    |      |      |       /-----2
    |      |       \-----1
     \-----0
    
    [0,6,1,5,2,3,4]
    |       /-----6
    |      |      |       /-----5
    |      |      |      |      |              /-----4
    |      |      |      |      |       /-----3
    |      |      |      |       \-----2
    |      |       \-----1
     \-----0
    
    [0,6,1,5,2,4,3]
    |       /-----6
    |      |      |       /-----5
    |      |      |      |      |       /-----4
    |      |      |      |      |      |       \-----3
    |      |      |      |       \-----2
    |      |       \-----1
     \-----0
    
    [0,6,1,5,4,2,3]
    |       /-----6
    |      |      |       /-----5
    |      |      |      |       \-----4
    |      |      |      |             |       /-----3
    |      |      |      |              \-----2
    |      |       \-----1
     \-----0
    
    [0,6,1,5,4,3,2]
    |       /-----6
    |      |      |       /-----5
    |      |      |      |       \-----4
    |      |      |      |              \-----3
    |      |      |      |                     \-----2
    |      |       \-----1
     \-----0
    
    [0,6,5,1,2,3,4]
    |       /-----6
    |      |       \-----5
    |      |             |                     /-----4
    |      |             |              /-----3
    |      |             |       /-----2
    |      |              \-----1
     \-----0
    
    [0,6,5,1,2,4,3]
    |       /-----6
    |      |       \-----5
    |      |             |              /-----4
    |      |             |             |       \-----3
    |      |             |       /-----2
    |      |              \-----1
     \-----0
    
    [0,6,5,1,4,2,3]
    |       /-----6
    |      |       \-----5
    |      |             |       /-----4
    |      |             |      |      |       /-----3
    |      |             |      |       \-----2
    |      |              \-----1
     \-----0
    
    [0,6,5,1,4,3,2]
    |       /-----6
    |      |       \-----5
    |      |             |       /-----4
    |      |             |      |       \-----3
    |      |             |      |              \-----2
    |      |              \-----1
     \-----0
    
    [0,6,5,4,1,2,3]
    |       /-----6
    |      |       \-----5
    |      |              \-----4
    |      |                    |              /-----3
    |      |                    |       /-----2
    |      |                     \-----1
     \-----0
    
    [0,6,5,4,1,3,2]
    |       /-----6
    |      |       \-----5
    |      |              \-----4
    |      |                    |       /-----3
    |      |                    |      |       \-----2
    |      |                     \-----1
     \-----0
    
    [0,6,5,4,3,1,2]
    |       /-----6
    |      |       \-----5
    |      |              \-----4
    |      |                     \-----3
    |      |                           |       /-----2
    |      |                            \-----1
     \-----0
    
    [0,6,5,4,3,2,1]
    |       /-----6
    |      |       \-----5
    |      |              \-----4
    |      |                     \-----3
    |      |                            \-----2
    |      |                                   \-----1
     \-----0
    
    [6,0,1,2,3,4,5]
     \-----6
           |                                   /-----5
           |                            /-----4
           |                     /-----3
           |              /-----2
           |       /-----1
            \-----0
    
    [6,0,1,2,3,5,4]
     \-----6
           |                            /-----5
           |                           |       \-----4
           |                     /-----3
           |              /-----2
           |       /-----1
            \-----0
    
    [6,0,1,2,5,3,4]
     \-----6
           |                     /-----5
           |                    |      |       /-----4
           |                    |       \-----3
           |              /-----2
           |       /-----1
            \-----0
    
    [6,0,1,2,5,4,3]
     \-----6
           |                     /-----5
           |                    |       \-----4
           |                    |              \-----3
           |              /-----2
           |       /-----1
            \-----0
    
    [6,0,1,5,2,3,4]
     \-----6
           |              /-----5
           |             |      |              /-----4
           |             |      |       /-----3
           |             |       \-----2
           |       /-----1
            \-----0
    
    [6,0,1,5,2,4,3]
     \-----6
           |              /-----5
           |             |      |       /-----4
           |             |      |      |       \-----3
           |             |       \-----2
           |       /-----1
            \-----0
    
    [6,0,1,5,4,2,3]
     \-----6
           |              /-----5
           |             |       \-----4
           |             |             |       /-----3
           |             |              \-----2
           |       /-----1
            \-----0
    
    [6,0,1,5,4,3,2]
     \-----6
           |              /-----5
           |             |       \-----4
           |             |              \-----3
           |             |                     \-----2
           |       /-----1
            \-----0
    
    [6,0,5,1,2,3,4]
     \-----6
           |       /-----5
           |      |      |                     /-----4
           |      |      |              /-----3
           |      |      |       /-----2
           |      |       \-----1
            \-----0
    
    [6,0,5,1,2,4,3]
     \-----6
           |       /-----5
           |      |      |              /-----4
           |      |      |             |       \-----3
           |      |      |       /-----2
           |      |       \-----1
            \-----0
    
    [6,0,5,1,4,2,3]
     \-----6
           |       /-----5
           |      |      |       /-----4
           |      |      |      |      |       /-----3
           |      |      |      |       \-----2
           |      |       \-----1
            \-----0
    
    [6,0,5,1,4,3,2]
     \-----6
           |       /-----5
           |      |      |       /-----4
           |      |      |      |       \-----3
           |      |      |      |              \-----2
           |      |       \-----1
            \-----0
    
    [6,0,5,4,1,2,3]
     \-----6
           |       /-----5
           |      |       \-----4
           |      |             |              /-----3
           |      |             |       /-----2
           |      |              \-----1
            \-----0
    
    [6,0,5,4,1,3,2]
     \-----6
           |       /-----5
           |      |       \-----4
           |      |             |       /-----3
           |      |             |      |       \-----2
           |      |              \-----1
            \-----0
    
    [6,0,5,4,3,1,2]
     \-----6
           |       /-----5
           |      |       \-----4
           |      |              \-----3
           |      |                    |       /-----2
           |      |                     \-----1
            \-----0
    
    [6,0,5,4,3,2,1]
     \-----6
           |       /-----5
           |      |       \-----4
           |      |              \-----3
           |      |                     \-----2
           |      |                            \-----1
            \-----0
    
    [6,5,0,1,2,3,4]
     \-----6
            \-----5
                  |                            /-----4
                  |                     /-----3
                  |              /-----2
                  |       /-----1
                   \-----0
    
    [6,5,0,1,2,4,3]
     \-----6
            \-----5
                  |                     /-----4
                  |                    |       \-----3
                  |              /-----2
                  |       /-----1
                   \-----0
    
    [6,5,0,1,4,2,3]
     \-----6
            \-----5
                  |              /-----4
                  |             |      |       /-----3
                  |             |       \-----2
                  |       /-----1
                   \-----0
    
    [6,5,0,1,4,3,2]
     \-----6
            \-----5
                  |              /-----4
                  |             |       \-----3
                  |             |              \-----2
                  |       /-----1
                   \-----0
    
    [6,5,0,4,1,2,3]
     \-----6
            \-----5
                  |       /-----4
                  |      |      |              /-----3
                  |      |      |       /-----2
                  |      |       \-----1
                   \-----0
    
    [6,5,0,4,1,3,2]
     \-----6
            \-----5
                  |       /-----4
                  |      |      |       /-----3
                  |      |      |      |       \-----2
                  |      |       \-----1
                   \-----0
    
    [6,5,0,4,3,1,2]
     \-----6
            \-----5
                  |       /-----4
                  |      |       \-----3
                  |      |             |       /-----2
                  |      |              \-----1
                   \-----0
    
    [6,5,0,4,3,2,1]
     \-----6
            \-----5
                  |       /-----4
                  |      |       \-----3
                  |      |              \-----2
                  |      |                     \-----1
                   \-----0
    
    [6,5,4,0,1,2,3]
     \-----6
            \-----5
                   \-----4
                         |                     /-----3
                         |              /-----2
                         |       /-----1
                          \-----0
    
    [6,5,4,0,1,3,2]
     \-----6
            \-----5
                   \-----4
                         |              /-----3
                         |             |       \-----2
                         |       /-----1
                          \-----0
    
    [6,5,4,0,3,1,2]
     \-----6
            \-----5
                   \-----4
                         |       /-----3
                         |      |      |       /-----2
                         |      |       \-----1
                          \-----0
    
    [6,5,4,0,3,2,1]
     \-----6
            \-----5
                   \-----4
                         |       /-----3
                         |      |       \-----2
                         |      |              \-----1
                          \-----0
    
    [6,5,4,3,0,1,2]
     \-----6
            \-----5
                   \-----4
                          \-----3
                                |              /-----2
                                |       /-----1
                                 \-----0
    
    [6,5,4,3,0,2,1]
     \-----6
            \-----5
                   \-----4
                          \-----3
                                |       /-----2
                                |      |       \-----1
                                 \-----0
    
    [6,5,4,3,2,0,1]
     \-----6
            \-----5
                   \-----4
                          \-----3
                                 \-----2
                                       |       /-----1
                                        \-----0
    
    [6,5,4,3,2,1,0]
     \-----6
            \-----5
                   \-----4
                          \-----3
                                 \-----2
                                        \-----1
                                               \-----0
    

*/
  
  }

}

